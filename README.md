# cosense 文件夹说明

本文件夹包含用于 Carla 仿真平台的不同场景下车辆仿真、数据采集与分析的核心 Python 脚本。以下是每个脚本的功能简介：

## 文件列表及功能

- **Spectator.py**  
  连接 Carla 仿真环境，控制观众视角，获取并打印当前观众的位置信息和朝向。适合用于调试或场景观察。

- **Waypoint.py**  
  获取地图所有推荐的车辆生成点（spawn points），打印前10个作为起点候选，并选定起点和终点。适用于路径规划和车辆初始化。

- **duqu.py**  
  使用 numpy 加载车辆深度相机的 `.npy` 数据文件，并打印出来。用于调试或分析感知数据。

- **analyze_photos.py**  
  批量分析车辆采集的照片及其元数据，计算每辆车在不同位置的可见区域面积，自动评分并输出排名。适合进行感知能力评估和环境遮挡分析。

- **map.py**  
  连接到 Carla 仿真环境，输出地图生成点信息、地图范围，并筛选街道上的生成点。用于场景规划和数据采集区域选择。

- **passtime.py**  
  基于 Carla，自动控制车辆从起点行驶到终点，支持路径可视化、轨迹绘制和自动变道。包含自动资源清理，适合路径跟踪与仿真测试。

- **sim.py**  
  Carla 仿真场景核心脚本。包括道路停车车辆批量生成、运动车辆（感知/普通车辆）生成、摄像头自动数据采集、仿真主循环、资源清理等。适用于自动化批量仿真和数据采集场景。

## 依赖环境

- Python 3
- [Carla 仿真平台](https://carla.org/)
- numpy
- 其他常用 Python 标准库

## 目录结构建议

- `output/camera_images/`：存放车辆采集到的图片及元数据。
- `output/analysis_results/`：存放图片分析结果（如排名与得分）。

## 使用说明

1. 启动 Carla 仿真服务端（建议使用适配的地图，如 Town04 或 Town10HD）。
2. 按需运行不同脚本：
   - 数据采集：`sim.py`
   - 路径分析：`passtime.py`
   - 观众视角调试：`Spectator.py`
   - 可见区域分析：`analyze_photos.py`
3. 可根据实际场景修改脚本中的参数（如车辆数量、起终点位置等）。
4. 推荐逐步调试，每次仿真结束注意资源清理。

## 联系与反馈

如有问题或建议，欢迎提交 Issue 或 Pull Request。
